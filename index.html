<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Project one</title>
    <style>
      h1 {
        text-align: center;
      }
      .personalPage {
        display: none;
        padding: 5px;
        
      }
      .mainC {
        display: flex;
        flex-direction: column;
        justify-content: center;
        background-color: rgb(223, 223, 223);
        max-width: 300px;
      }
      
      .flexCenter {
        display: flex;
        justify-content: center;
      }
      .cartDiv {
        padding-top: 10px;
      }
      .logo1 {
        
        width: 10%;
        float: left;
      }
      .logo2 {
        
        width: 10%;
        float: right;
      }
      .createCartP {
        text-align: center;
      }
      .hello {
        padding-left: 5px;
        text-align: center;
      }
      .deleteBtn {
        display: none;
        width: 50%;
        align-self: center;
      }
     


    </style>
  </head>
  <body>
    <div class="flexCenter">
      
    <div class="mainC">
      <div>
        <img class="logo1" src="cart.png">
        <img class="logo2" src="cart.png">
        <h1>Shopping List</h1>
      </div>

      <p class="createCartP">Create new one or use existing shopping cart</p>
      <button class="loginBtn">Create Shopping cart</button>
      <select>
        <option disabled selected value>Choose saved Carts</option>
      </select>
      <h2 class="hello"></h2>
      <button class="deleteBtn">Delete current cart</button>
      <div class="personalPage">
        <p>Add item in your shopping list</p>
        <input required type="text" class="addItem" placeholder="Shopping item">
        <button class="add">Add</button>
        <div class="cartDiv">
        </div>
        
      
    </div>
    </div>
    
    </div>
    




    <script>
      const personalPage = document.querySelector('.personalPage');
      const loginBtn = document.querySelector('.loginBtn');
      const itemInput = document.querySelector('.addItem');
      const addBtn = document.querySelector('.add')
      const hello = document.querySelector('.hello');
      const orderedList = document.querySelector('.cartDiv');
      const select = document.querySelector('select');
      let createCartP = document.querySelector('.createCartP');
      const inputArea = document.querySelector('.inputArea');
      const deleteBtn = document.querySelector('.deleteBtn');
      let text;
     

      let profile = {};

        Storage.prototype.setObj = function(key, obj) {
          return this.setItem(key, JSON.stringify(obj))
        }
        Storage.prototype.getObj = function(key) {
          return JSON.parse(this.getItem(key))
        }

      loginBtn.addEventListener('click', register);
      let promptValue;
      let selectOption;
      profile.names = [];
      function register() {
        promptValue = prompt('Shopping Cart Name', '');
        localProfile = localStorage.getObj('profile');
        if (promptValue == null || promptValue == '') {
          text = 'Please try again, fields empty';
          personalPage.style.display = 'none';
          deleteBtn.style.display ='none';
        } if (promptValue) {
            text = 'Shopping Cart:' + ' ' + promptValue;
            orderedList.textContent = '';
            
            profile.names.push(promptValue);
            profile[promptValue] = {};
            profile[promptValue].list = [];
            personalPage.style.display = 'block';
            deleteBtn.style.display = 'block';
            selectOption = document.createElement('option');
            selectOption.textContent = promptValue;
            select.appendChild(selectOption);

            if (localProfile[promptValue]) {
              for (let i = 0; i < localProfile[promptValue].list.length; i++) {
              let li = document.createElement('li');
              let checkbox = document.createElement('input');
              checkbox.type = 'checkbox';
              li.textContent = localProfile[promptValue].list[i];
              li.appendChild(checkbox);
              orderedList.appendChild(li);
              }
            }
        }

        hello.textContent = text;
        createCartP.style.display = 'none';
      }

      addBtn.addEventListener('click', function() {
         
          profile[promptValue].currentItem = itemInput.value;
          profile[promptValue].list.push(itemInput.value);
          updateShoppingList();
        }
      );
      
      function updateShoppingList() {
        let li = document.createElement('li');
        let checkbox = document.createElement('input');
        checkbox.type = 'checkbox';
        li.textContent = profile[promptValue].currentItem + ' ';
        profile[promptValue].currentItem = '';
        li.appendChild(checkbox);
        orderedList.appendChild(li);
        localStorage.setObj('profile', profile);

        itemInput.value = '';
        itemInput.focus();
        }
        
        select.addEventListener('change', function() {
          localProfile = localStorage.getObj('profile');
          let selectValue = select.value;
          orderedList.textContent = '';
          text = 'Shopping Cart: ' + selectValue
          hello.textContent = text;
            for (let i = 0; i < localProfile[selectValue].list.length; i++) {
              let li = document.createElement('li');
              let checkbox = document.createElement('input');
              checkbox.type = 'checkbox';
              li.textContent = localProfile[selectValue].list[i];
              li.appendChild(checkbox);
              orderedList.appendChild(li);
              }
        });

        //document.body.onload = function() {
          //localProfile = localStorage.getObj('profile');
          //selectOption = documentCreateElement

        //}
        document.body.onload = function() {
          localStorage.setObj('profile', profile);
        };




        deleteBtn.addEventListener('click', function() {
          saveListA = [];
          listedItem.textContent = '';

          localStorage.removeItem('itemName' + name);
          updateShoppingList();
          
        });
        
    </script>
  </body>
</html>
