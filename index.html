<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Project one</title>
    <style>
      h1 {
        text-align: center;
      }
      .personalPage {
        display: none;
        padding: 5px;
        
      }
      .mainC {
        display: flex;
        flex-direction: column;
        justify-content: center;
        background-color: rgb(223, 223, 223);
        max-width: 300px;
      }
      
      .flexCenter {
        display: flex;
        justify-content: center;
      }
      .cartDiv {
        padding-top: 10px;
      }
      .logo1 {
        
        width: 10%;
        float: left;
      }
      .logo2 {
        
        width: 10%;
        float: right;
      }
      .createCartP {
        text-align: center;
      }
      .hello {
        padding-left: 5px;
        text-align: center;
      }
      .deleteBtn {
        display: none;
        width: 50%;
        align-self: center;
      }
     


    </style>
  </head>
  <body>
    <div class="flexCenter">
      
    <div class="mainC">
      <div>
        <img class="logo1" src="cart.png">
        <img class="logo2" src="cart.png">
        <h1>Shopping List</h1>
      </div>

      <p class="createCartP">Create new one or use existing shopping cart</p>
      <button class="loginBtn">Create Shopping cart</button>
      <select class="select">
        <option disabled selected value>Choose saved carts</option>
      </select>
      <h2 class="hello"></h2>
      <button class="deleteBtn">Delete current cart</button>
      <div class="personalPage">
        <p>Add item in your shopping list</p>
        <input required type="text" class="addItem" placeholder="Shopping item">
        <button class="add">Add</button>
        <div class="cartDiv">
        </div>
        
      
    </div>
    </div>
    
    </div>
    




    <script>
      const personalPage = document.querySelector('.personalPage');
      const loginBtn = document.querySelector('.loginBtn');
      const itemInput = document.querySelector('.addItem');
      const addBtn = document.querySelector('.add');
      const hello = document.querySelector('.hello');
      const orderedList = document.querySelector('.cartDiv');
      const select = document.querySelector('.select');
      let createCartP = document.querySelector('.createCartP');
      const inputArea = document.querySelector('.inputArea');
      const deleteBtn = document.querySelector('.deleteBtn');
      let text;
     
      let names = {};
      let profile = {};

      Storage.prototype.setObj = function(key, obj) {
        return this.setItem(key, JSON.stringify(obj))
      }
      Storage.prototype.getObj = function(key) {
        return JSON.parse(this.getItem(key))
      }

      loginBtn.addEventListener('click', register);
      let promptValue;
      function register() {
        promptValue = prompt('Shopping Cart Name', '');
        if (promptValue != null || promptValue != '') {
        let localNames = localStorage.getObj('nameeList');

        if (localNames == null && promptValue != null && promptValue != '') {
          names.list = [];
          names.list.push(promptValue);
          names.boolean = '';
          localStorage.setObj('nameeList', names)
        };

        function booleanList() {
          for (let i = 0; i < localNames.list.length; i++) {
          if (localNames.list[i] != promptValue && promptValue != null || promptValue != '') {
            localNames.boolean = false;
          } else {
            return localNames.boolean = true;
          }
        }
        };

        localNames.boolean = '';
        booleanList();
        if (localNames.boolean == false && promptValue != '') {
          localNames.list.push(promptValue);
          localStorage.setObj('nameeList', localNames)
        }
        
        let localProfile = localStorage.getObj(promptValue);
         if (localProfile == null && promptValue != null || promptValue != '') {
            text = 'Shopping Cart:' + ' ' + promptValue;
            orderedList.textContent = '';
            profile[promptValue] = {};
            profile[promptValue].list = [];
            personalPage.style.display = 'block';
            deleteBtn.style.display = 'block';
            hello.textContent = text;
            createCartP.style.display = 'none';
            let selectOption = document.createElement('option');
            selectOption.textContent = promptValue;
            select.appendChild(selectOption);
        }
        if (localProfile != null && promptValue != null || promptValue != '') {
              text = 'Shopping Cart:' + ' ' + promptValue;
              orderedList.textContent = '';
              hello.textContent = text;
              for (let i = 0; i < localProfile[promptValue].list.length; i++) {
              let li = document.createElement('li');
              let checkbox = document.createElement('input');
              checkbox.type = 'checkbox';
              li.textContent = localProfile[promptValue].list[i] + ' ';
              li.appendChild(checkbox);
              orderedList.appendChild(li);
              personalPage.style.display = 'block';
              deleteBtn.style.display = 'block';
              }
        }
      }
        if (promptValue == null || promptValue == '') {
          text = 'Please try again, fields empty';
          personalPage.style.display = 'none';
          deleteBtn.style.display = 'none';
        }

        hello.textContent = text;
        createCartP.style.display = 'none';
      }

      addBtn.addEventListener('click', function() {
          let localProfile = localStorage.getObj(promptValue);
          if (localProfile != null) {
            localProfile[promptValue].list.push(itemInput.value);
            localProfile[promptValue].currentItem = itemInput.value;
            localStorage.setObj(promptValue, localProfile);
            updateShoppingListLocal();
          } else {

            profile[promptValue].currentItem = itemInput.value;
            profile[promptValue].list.push(itemInput.value);
            updateShoppingList();
          }
          }
        );
      
      function updateShoppingList() {
          let li = document.createElement('li');
          let checkbox = document.createElement('input');
          checkbox.type = 'checkbox';
          li.textContent = profile[promptValue].currentItem + ' ';
          profile[promptValue].currentItem = '';
          li.appendChild(checkbox);
          orderedList.appendChild(li);
          localStorage.setObj(promptValue, profile);

          itemInput.value = '';
          itemInput.focus();
          }


      function updateShoppingListLocal() {
          let localProfile = localStorage.getObj(promptValue);
          let li = document.createElement('li');
          let checkbox = document.createElement('input');
          checkbox.type = 'checkbox';
          li.textContent = localProfile[promptValue].currentItem + ' ';
          localProfile[promptValue].currentItem = '';
          li.appendChild(checkbox);
          orderedList.appendChild(li);
          localStorage.setObj(promptValue, localProfile);

          itemInput.value = '';
          itemInput.focus();
        }

      document.body.onload = function() {
          let localNames = localStorage.getObj('nameeList');
          for (let i = 0; i < localNames.list.length; i++) {
            let selectOption = document.createElement('option');
            selectOption.textContent = localNames.list[i];
            select.appendChild(selectOption);

          }
        }

        
      select.addEventListener('change', function() {
          let selectValue = select.value;
          let localProfile = localStorage.getObj(selectValue);
          text = 'Shopping Cart:' + ' ' + selectValue;
          orderedList.textContent = '';
          hello.textContent = text;
          for (let i = 0; i < localProfile[selectValue].list.length; i++) {
          let li = document.createElement('li');
          let checkbox = document.createElement('input');
          checkbox.type = 'checkbox';
          li.textContent = localProfile[selectValue].list[i] + ' ';
          li.appendChild(checkbox);
          orderedList.appendChild(li);
          personalPage.style.display = 'block';
          deleteBtn.style.display = 'block';
        }
      });

      deleteBtn.addEventListener('click', function() {
          saveListA = [];
          listedItem.textContent = '';

          localStorage.removeItem('itemName' + name);
          updateShoppingList();
          
        });

        
        
    </script>
  </body>
</html>
